\documentclass[11pt]{article}

\usepackage{xcolor}
\usepackage{amsmath,amssymb,amsthm}
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}
\newcommand{\Frobenius}[1]{\left\lVert#1\right\rVert_F}
\usepackage[margin=1in]{geometry}
\usepackage{hyperref}

% Theorem environments
\newtheorem{assumption}{Assumption}

\title{Tracking Realizable Trajectories via Incremental Exponential Stability}
\author{Aditya Gahlawat}
\date{}

\begin{document}

\maketitle

\tableofcontents

\section{Nonlinear System}

Consider the control-affine system
\[
\dot x = f_{ol}(x) + G u .
\]
% 
Assume a state-feedback controller
\[
u = k(x),
\]
and define the closed-loop vector field
\[
f_{cl}(x) := f_{ol}(x) + G k(x).
\]

\begin{assumption}[Incremental Exponential Stability]
The system
\[
\dot z = f_{cl}(z)
\]
is \textbf{incrementally exponentially stable (IES)}, i.e., there exist constants $c \ge 1$ and $\lambda > 0$ such that for any two solutions $z_1(t)$, $z_2(t)$,
\[
\| z_1(t) - z_2(t) \| \le c e^{-\lambda t} \| z_1(0) - z_2(0) \| .
\]
\end{assumption}

\section{Reference Trajectory and Feedback--Feedforward Structure}

Let $x^\star(t)$ be a realizable reference trajectory generated by
\[
\dot x^\star = f_{ol}(x^\star) + G u^\star .
\]
Add and subtract $k(x^\star)$:
\[
\dot x^\star = f_{cl}(x^\star) + G\big(u^\star - k(x^\star)\big) .
\]
Defining
\[
v^\star := u^\star - k(x^\star),
\]
the reference input admits a \textbf{feedback + feedforward decomposition}.
% 
We can thus use the following \textbf{feedback + feedforward control law} for the actual system:
\[
u = k(x) + v^\star ,
\]
where $v^\star$ is the \textbf{feedforward term induced by the reference trajectory $(x^\star, u^\star)$} as defined above.

This yields the closed-loop dynamics
\[
\dot x = f_{cl}(x) + G v^\star,
\qquad
\dot x^\star = f_{cl}(x^\star) + G v^\star .
\]

\section{{\color{red} General use in $\mathcal{L}_1$-DRAC}}

As in the manuscript, we define 
\begin{align}\label{eqn:main_f}
       f(t,x) :=  f_{cl}(x) + G v^\star(t) 
       =& f_{ol}(x) + G \left( k(x) + u^\star(t) - k\left(x^\star(t)\right) \right)
       \notag 
       \\     
       =& f_{ol}(x) + G \left( k(x)  - k\left(x^\star(t)\right) \right)    +  G  u^\star(t). 
\end{align}
If we assume that the nominal law $k$ is Lipschitz, i.e., there exists $L_k >0$ such that
\begin{align*}
       \norm{k(x) - k\left(x^\star\right)} \leq L_k \norm{x-x^\star}, \quad \forall x,x^\star \in \mathbb{R}^n,
\end{align*}
then, the bound in the paper should be changed from 
\begin{align*}
       \norm{f(t,x)} \leq \Delta_f \left(1+\norm{x}^2\right)^\frac{1}{2}, \quad \forall t,x,
\end{align*}
to
\begin{align}\label{eqn:f_bound:change:1}
       \norm{f(t,x)} 
       \leq 
       \Delta_{f_{ol}} \left(1+\norm{x}^2\right)^\frac{1}{2} 
       +L_k \norm{x-x^\star} + \norm{G}\norm{u^\star(t)}, \quad \forall t,x.
\end{align}
which we will further change to reduce the conservatism as follows:
\begin{align}\label{eqn:f_bound:change:2}
       \norm{f(t,x)} 
       \leq 
        \left(\Delta_{f_1}^2+\Delta_{f_2}^2\norm{x}^2\right)^\frac{1}{2} 
       +L_k \norm{x-x^\star} \quad \forall t,x,
\end{align}
for some known constants $\Delta_{f_1},\Delta_{f_2}, L_k \geq 0$, and where $\norm{G}\norm{u^\star(t)}$ is absorbed into $\Delta_{f_1}$.


\begin{align*}
       % \norm{f_{cl}(t,x)}
\end{align*}

\section{Error Dynamics}

Define the tracking error
\[
e := x - x^\star .
\]

Then
\[
\dot e = f_{cl}(x) - f_{cl}(x^\star)
       = f_{cl}(x^\star + e) - f_{cl}(x^\star) .
\]

\subsection{Interpretation}

Since $x(t)$ and $x^\star(t)$ satisfy the \textbf{same system}
\[
\dot z = f_{cl}(z) + G v^\star(t),
\]
and $\dot z = f_{cl}(z)$ is incrementally exponentially stable, the error dynamics represent the distance between two trajectories of an IES system.

\section{Special Case: Linear Time-Invariant (LTI) Systems}

\subsection{LTI Plant}

Consider the LTI system
\[
\dot x = A x + B u ,
\]
with linear state-feedback
\[
u = K x ,
\]
and assume
\[
A + B K \quad \text{is Hurwitz}.
\]

Define
\[
f_{cl}(x) := (A + B K) x .
\]

\subsection{Reference Trajectory and Feedback--Feedforward Structure}

Let the reference trajectory satisfy
\[
\dot x^\star = A x^\star + B u^\star .
\]

Defining
\[
v^\star := u^\star - K x^\star ,
\]
the reference input admits a \textbf{feedback + feedforward decomposition}.

We can thus use the following \textbf{feedback + feedforward control law} for the actual system:
\[
u = K x + v^\star ,
\]
where $v^\star$ is the \textbf{feedforward term induced by the reference trajectory $(x^\star, u^\star)$}.

This yields
\[
\dot x
=
f(t,x) 
:= 
(A + B K) x + B v^\star,
\qquad
\dot x^\star = (A + B K) x^\star + B v^\star .
\]

\subsection{{\color{red} General use in $\mathcal{L}_1$-DRAC}}

We have that 
\begin{align*}
       \norm{f(t,x)} 
       =& \norm{(A + B K) x + B v^\star(t)}
       \\
       =& \norm{(A + B K) x + B \left(u^\star(t) - K x^\star(t)\right)} 
       \\
       \leq& \Frobenius{A} \norm{x} + \Frobenius{B}\Frobenius{K}\norm{x(t) - x^\star(t)} + \Frobenius{B}\norm{u^\star(t)}, \quad \forall t,x.
\end{align*}
Then, as in~\eqref{eqn:f_bound:change:2}, we will determine constants $\Delta_{f_1},\Delta_{f_2}, L_k \geq 0$, such that 
\begin{align}
       \norm{f(t,x)} 
       = 
       \norm{(A+Bk)x + Bv^\star(t)}
       \leq 
        \left(\Delta_{f_1}^2+\Delta_{f_2}^2\norm{x}^2\right)^\frac{1}{2} 
       +L_k \norm{x-x^\star} + \norm{G}\norm{u^\star(t)}, \quad \forall t,x,
\end{align}
where $\Delta_{f_1}$ is defined to reflect $\Frobenius{B}\norm{u^\star(t)}$, $\Delta_{f_2} = \Frobenius{A}$, and $L_k = \Frobenius{B}\Frobenius{K}$.
Note that {\color{red} $u^\star$ comes from a planner, in our case, covariance steering, so we can put constraints on its (expected) magnitude to help define $\Delta_{f_1}$. Vivek has already established this.}


\subsection{Error Dynamics}

Define $e := x - x^\star$. Then
\[
\dot e = (A + B K) e .
\]

\subsection{Interpretation (LTI)}

Since $A + B K$ is Hurwitz, the system is incrementally exponentially stable, and the tracking error satisfies
\[
\| e(t) \| \le c e^{-\lambda t} \| e(0) \| ,
\]
for some $c \ge 1$, $\lambda > 0$, independent of the reference input $u^\star$.

\nocite{placeholder}
\bibliographystyle{plain}
\bibliography{TrackingSetupIES}

\end{document}
